<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="theboss_hr_job_survey" model="ir.ui.view">
        <field name="name">hr.job.form.inherit</field>
        <field name="model">hr.job</field>
        <field name="inherit_id" ref="hr_recruitment.hr_job_survey"/>
        <!-- <field name="mode">primary</field> -->
        <field name="arch" type="xml">
            <!-- <xpath expr="//field[@name='address_id']" position="before">
                <label for="survey_id" groups="base.group_user"/>
                <div groups="base.group_user" class="o_row">
                    <field name="survey_id"/>
                    <button string="Display Interview Form" name="action_print_survey" type="object" attrs="{'invisible':[('survey_id','=',False)]}" class="oe_link"/>
                </div>
            </xpath> -->
            
            <xpath expr="//field[@name='description']" position="replace">
                <notebook>
                    <page string="Job description" >
                        <field name="description" />
                    </page>
                    <page string="Stage Interviews" >
                        <field name="stage_interviews" />
                    </page>
                    <page string="Stage Tasks" >
                        <field name="stage_tasks" />
                    </page>
                </notebook>

            </xpath>
        </field>
    </record>

    <record id="theboss_hr_stage_interview_view_tree" model="ir.ui.view">
      <field name="name">theboss_hr.stage_interview.tree</field>
      <field name="model">theboss_hr.stage_interview</field>
      <field name="arch" type="xml">
        <tree string="Stage Interviews">
          <field name="name"/>
          <field name="stage_id"/>
          <field name="survey_id"/>
        </tree>
      </field>
    </record>

     <record id="theboss_hr_stage_interview_view_form" model="ir.ui.view">
      <field name="name">theboss_hr.stage_interview.form</field>
      <field name="model">theboss_hr.stage_interview</field>
      <field name="arch" type="xml">
        <form>
            <sheet>
                <group>
                    <field name="name"/>
                    <field name="stage_id"/>
                    <field name="survey_id"/>
                </group>
            </sheet>
        </form>
      </field>
    </record>

    <record id="theboss_hr_stage_task_view_tree" model="ir.ui.view">
      <field name="name">theboss_hr.stage_task.tree</field>
      <field name="model">theboss_hr.stage_task</field>
      <field name="arch" type="xml">
        <tree string="Stage Interviews">
          <field name="name"/>
          <field name="stage_id"/>
          <field name="activity_type_id"/>
        </tree>
      </field>
    </record>

     <record id="theboss_hr_stage_task_view_form" model="ir.ui.view">
      <field name="name">theboss_hr.stage_task.form</field>
      <field name="model">theboss_hr.stage_task</field>
      <field name="arch" type="xml">
        <form>
            <sheet>
                <group>
                    <field name="name"/>
                    <field name="stage_id"/>
                    <field name="activity_type_id"/>
                </group>
            </sheet>
        </form>
      </field>
    </record>

    <record id="action_theboss_hr_stage_interview_act_window" model="ir.actions.act_window">
        <field name="type">ir.actions.act_window</field>
        <field name="name">Job Interview per stage</field>
        <field name="res_model">theboss_hr.stage_interview</field>
        <field name="view_mode">tree,form</field>
        <field name="view_type">form</field>
        <field name="target">current</field>
        <field name="context">{'job_id': active_id}</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Click to add new stage job interview
            </p><p>
                Once a job position interview is created, you can track related applications
              and manage the recruitment process.
            </p>
        </field>
    </record>

    <record id="action_theboss_hr_stage_task_act_window" model="ir.actions.act_window">
        <field name="type">ir.actions.act_window</field>
        <field name="name">Job Interview per stage</field>
        <field name="res_model">theboss_hr.stage_task</field>
        <field name="view_mode">tree,form</field>
        <field name="view_type">form</field>
        <field name="target">current</field>
        <field name="context">{'job_id': active_id}</field>
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
                Click to add new stage job activities
            </p><p>
                Once a job position interview is created, you can track related applications
              and manage the recruitment process.
            </p>
        </field>
    </record>

    <record id="view_hr_job_kanban_inherit" model="ir.ui.view">
        <field name="name">hr.job.kanban.inherit</field>
        <field name="model">hr.job</field>
        <field name="inherit_id" ref="hr_recruitment.view_hr_job_kanban"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='manager_id']" position="after">
                <field name="stage_interviews"/>
                <field name="stage_tasks"/>
            </xpath> 
            <xpath expr='//div[@name="recruitment"]' position="before">
                <div class="row">
                    <div class="col-xs-12">
                        <a t-if="record.stage_interviews.raw_value" name="%(action_theboss_hr_stage_interview_act_window)d" 
                        type="action" 
                        context="{'default_job_id': active_id}"
                        title="Display Interview Forms">Interview Forms</a>
                         <a t-if="record.stage_tasks.raw_value" name="%(action_theboss_hr_stage_task_act_window)d" 
                        type="action" 
                        context="{'default_job_id': active_id}"
                        title="Display Activities to be done">HR Job Activities</a>
                    </div>
                </div>
            </xpath>
        </field>
    </record>

    <record id="crm_case_form_view_job_inherit" model="ir.ui.view">
        <field name="name">hr.applicant.form.inherit</field>
        <field name="model">hr.applicant</field>
        <field name="inherit_id" ref="hr_recruitment.crm_case_form_view_job"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='action_makeMeeting']" position="after">
                <button name="action_start_survey"
                    class="oe_stat_button"
                    icon="fa-user"
                    type="object"
                    help="Answer related job question"
                    context="{'survey_id': stage_interview_id}"
                    attrs="{'invisible':[('stage_interview_id','=',False)]}">
                    <div class="o_field_widget o_stat_info">
                        <span class="o_stat_text">Start</span>
                        <field name="stage_interview_id" class="o_stat_text"/>
                    </div>
                </button>
                <button name="action_print_survey"
                    class="oe_stat_button"
                    icon="fa-print"
                    type="object"
                    help="Print interview report"
                    attrs="{'invisible':[('response_id','=',False)]}">
                    <div class="o_field_widget o_stat_info">
                        <span class="o_stat_text">Sore</span>
                        <field name="score" class="o_stat_text"/>
                    </div>
                </button>
                <button name="action_generate_documents"
                    class="oe_stat_button"
                    icon="fa-gears"
                    type="object"
                    help="Generate template documents"
                   >
                    <div class="o_field_widget o_stat_info">
                        <span class="o_stat_text">Generate HR doc</span>
                    </div>
                </button>
            </xpath>
            <xpath expr="//field[@name='job_id']" position="before">
                <field name="stage_interview_id" invisible="1"/>
                <field name="response_id" invisible="1"/>
            </xpath>
        </field>
    </record>
</odoo>