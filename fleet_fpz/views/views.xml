<odoo>
  <data>
    <!-- explicit list view definition -->
    <!-- Inherit Form view -->
    <record id="fleet_vehicle_view_form" model="ir.ui.view">
      <field name="name">fleet.vehicle.form</field>
      <field name="model">fleet.vehicle</field>
      <field name="inherit_id" ref="fleet.fleet_vehicle_view_form"/>
      <field name="arch" type="xml">
          <!-- Add your fields or attributes here -->
          <xpath expr="//group" position="after">
                 <group string="Sporuri pe masina" col="2">
                   <group>
                     <field name="cm"/>
                     <field name="spor_tractare_remorca1"/>
                     <field name="spor_tractare_remorca2"/>
                     <field name="sarcina_utila_nominala"/>
                   </group>
                   <group>
                     <field name="spor_buc"/>
                     <field name="spor_buc_cu_remorca"/>
                     <field name="spor_judet"/>
                     <field name="spor_judet_cu_remorca"/>
                     <field name="spor_alte"/>
                     <field name="spor_alte_cu_remorca"/>
                   </group>
                 </group>
             </xpath>
      </field>
    </record>
  
    <record id="fleet_vehicle_view_kanban" model="ir.ui.view">
      <field name="name">fleet.vehicle</field>
      <field name="model">fleet.vehicle</field>
      <field name="inherit_id" ref="fleet.fleet_vehicle_view_kanban"/>
      <field name="arch" type="xml">
        <xpath expr="//div[contains(@class, 'oe_kanban_details')]" position="after">
          <div class="o_project_kanban_manage">
               <a class="o_kanban_manage_toggle_button o_left" href="#">More <i class="fa fa-caret-down"/></a>
               <a type="object" name="toggle_favorite" class="o_right"><i t-attf-class="oe_inline fa o_dashboard_star #{record.status == 'm' ? 'fa-star' : 'fa-star-o'}" title="Status"/></a>
           </div>
        </xpath>
      </field>
    </record>

    <record model='ir.ui.view' id='fleet_fpz_foaie_de_parcurs_form'>
        <field name="name">fleet_fpz.foaie_de_parcurs.form</field>
        <field name="model">fleet_fpz.foaie_de_parcurs</field>
        <field name="arch" type="xml">
            <form string="Foaie de parcurs">
              <header>
                <button name="approve_button" state="approved" type="object" class="oe_stat_button" icon="fa-check"
                  attrs="{'invisible': [('state','!=','draft')]}"></button>

          	    <!--This will create the statusbar, thanks to the widget. -->
          	    <field name="state" widget="statusbar"/>
             </header>
                <sheet>
                  <div class="oe_button_box" name="button_box">
                      <button name="act_show_log_cost" type="object" class="oe_read_only oe_stat_button" icon="fa-usd" help="show all the costs for this vehicle" groups="fleet.fleet_group_manager">
                          <field name="index_km_total" widget="statinfo" string="Costs"/>
                      </button>
                  </div>
                  <div class="oe_title">
                    <label for="vehicle_id" class="oe_edit_only"/>
                      <h2>
                          <field name="vehicle_id" default_focus="1" placeholder="Masina cu nr"/>
                      </h2>
                    <label for="driver_id" class="oe_edit_only"/>
                      <h2>
                          <field name="driver_id" default_focus="1" placeholder="Soferul"/>
                      </h2>
                  </div>
                    <group col="2">
                        <group>
                            <field name="date" placeholder="Data"/>
                        </group>
                        <group>
                            <field name="numar" placeholder="Foaie de parcurs Numar"/>
                        </group>
                    </group>
                    <group>
                      <notebook colspan="4">
                        <page string="Calcul consum">
                          <group col="3">
                            <group string="Alimentare combustibil litri:">
                              <field name="fuel_pump"/>
                              <field name="fuel_bcf"/>
                              <field name="fuel_advance"/>
                              <field name="gm"/>
                            </group>
                            <group string="Index contor kilometric:">
                              <field name="index_km_start"/>
                              <field name="index_km_stop"/>
                              <field name="index_km_total" attrs="{'readonly': False}"/>
                              <field name="km_unknown"/>
                            </group>
                            <group string="Calcul consum">
                              <field name="joja_ant_rezervor"/>
                              <field name="joja_rezervor"/>
                              <field name="consum_comb_diference"/>
                            </group>
                          </group>
                         </page>
                         <page string="Parcurs: categorii drum">
                           <field name="road_categories" nolabel="1"/>
                           <group class="oe_subtotal_footer">
                             <field name="km_de_specificat"/>
                           </group>
                           <group col="3">
                             <group string="Parcurs echivalent:">
                               <field name="km_echiv_parcurs"/>
                               <field name="km_echiv_incarcat"/>
                               <field name="km_echiv_gol"/>
                             </group>
                             <group string="Timpul parcurs:">
                               <field name="timp_local" widget="float_time"/>
                               <field name="timp_inter" widget="float_time"/>
                               <field name="timp_inc_desc" widget="float_time"/>
                               <field name="total_work_time" widget="float_time"/>
                             </group>
                             <group string="Consum suplimentar:">
                               <field name="nr_porniri_opriri"/>
                               <field name="nr_incalzire_motor" attrs="{'invisible':[('conditii_nefavorabile', '!=', True)]}"/>
                               <field name="nr_curse_comb"/>
                               <field name="rezerva_aer" attrs="{'invisible':[('conditii_nefavorabile', '!=', False)]}"/>
                              <field name="conditii_nefavorabile"/>
                             </group>
                           </group>
                         </page>
                         <page string="Spor tractare circulatie urbana">
                           <group colspan="2" string="Spor circulatie urbana">
                               <table colspan="2" class="o_list_view table table-condensed table-striped">
                                 <thead>
                                   <tr>
                                     <th class="o_column">Parcurs</th>
                                     <th class="o_column">Km</th>
                                     <th class="o_column">Cu remorca?</th>
                                     <th class="o_column">Coef.</th>
                                     <th class="o_column">Km echiv.</th>
                                   </tr>
                                 </thead>
                                  <tr>
                                    <td>Bucuresti</td>
                                    <td><field name="km_urbani_buc" nolabel="1"/></td>
                                    <td><field name="km_urbani_buc_cu_remorca" nolabel="1"/></td>
                                    <td><field name="km_urbani_buc_coef" nolabel="1"/></td>
                                    <td><field name="km_urbani_buc_echiv" nolabel="1"/></td>
                                  </tr>
                                  <tr>
                                    <td>Municipii/Judet</td>
                                    <td><field name="km_urbani_judet" nolabel="1"/></td>
                                    <td><field name="km_urbani_judet_cu_remorca" nolabel="1"/></td>
                                    <td><field name="km_urbani_judet_coef" nolabel="1"/></td>
                                    <td><field name="km_urbani_judet_echiv" nolabel="1"/></td>
                                  </tr>
                                  <tr>
                                    <td>Alte orase</td>
                                    <td><field name="km_urbani_alte" nolabel="1"/></td>
                                    <td><field name="km_urbani_alte_cu_remorca" nolabel="1"/></td>
                                    <td><field name="km_urbani_alte_coef" nolabel="1"/></td>
                                    <td><field name="km_urbani_alte_echiv" nolabel="1"/></td>
                                  </tr>
                               </table>
                           </group>
                         </page>

                         <page string="Trasee">
                           <field name="trasee" nolabel="1"/>
                         </page>
                      </notebook>
                      <group class="oe_subtotal_footer">
                          <field name="fuel_total"/>
                          <field name="consum_comb"/>
                          <field name="km_echiv_sporuri" attrs="{'readonly': True}"/>
                          <field name="km_echiv_total" attrs="{'readonly': True}"/>
                          <field name="driver_cost" class="oe_subtotal_footer_separator"/>
                      </group>
                  </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="fleet_fpz_parcurs_drum_view_tree" model="ir.ui.view">
      <field name="name">fleet_fpz.parcurs_drum.tree</field>
      <field name="model">fleet_fpz.parcurs_drum</field>
      <field name="arch" type="xml">
        <tree string="Parcurs drum" editable="top">
          <field name="km"/>
          <field name="incarcat"/>
          <field name="categorie_drum_id"/>
          <field name="km_echivalent"/>
        </tree>
      </field>
    </record>

    <record id="fleet_fpz_parcurs_drum_traseu_view_tree" model="ir.ui.view">
      <field name="name">fleet_fpz.parcurs_drum_traseu.tree</field>
      <field name="model">fleet_fpz.parcurs_drum_traseu</field>
      <field name="arch" type="xml">
        <tree string="Parcurs drum">
          <field name="localitate_start"/>
          <field name="localitate_stop"/>
          <field name="data_start"/>
          <field name="data_stop"/>
          <field name="dist"/>
          <field name="viteza"/>
        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="fleet_fpz_foaie_de_parcurs_graph">
       <field name="name">fleet_fpz.foaie_de_parcurs.graph</field>
       <field name="model">fleet_fpz.foaie_de_parcurs</field>
       <field name="arch" type="xml">
            <graph string="Costs Per Month" stacked="True">
                <field name="date" type="row"/>
                <field name="vehicle_id" type="col"/>
                <field name="fuel_total" type="measure"/>
                <field name="consum_comb" type="measure"/>
            </graph>
        </field>
    </record>

    <record model="ir.ui.view" id="fleet_fpz_foaie_de_parcurs_tree">
       <field name="name">fleet_fpz.foaie_de_parcurs.tree</field>
       <field name="model">fleet_fpz.foaie_de_parcurs</field>
       <field name="arch" type="xml">
            <tree string="Foii de parcurs zilnice FAZ">
                <field name="date"/>
                <field name="vehicle_id"/>
                <field name="driver_id"/>
                <field name="fuel_total"/>
                <field name="index_km_total"/>
                <field name="km_echiv_total"/>
                <field name="consum_comb"/>
                <field name="consum_comb_diference"/>
                <field name="km_echiv_parcurs"/>
                <field name="km_echiv_incarcat"/>
            </tree>
        </field>
    </record>

    <record model='ir.actions.act_window' id='fleet_fpz_foaie_de_parcurs_act'>
       <field name="name">Foaie de parcurs</field>
       <field name="res_model">fleet_fpz.foaie_de_parcurs</field>
       <field name="view_type">form</field>
       <field name="view_mode">tree,form,graph</field>
       <field name="help" type="html">
         <p class="oe_view_nocontent_create">
           Clic aicea pentru a create o foaie de parcurs noua
         </p><p>
           Odoo helps you managing the costs for your different
           vehicles. Costs are created automatically from services,
           contracts (fixed or recurring) and fuel logs.
         </p>
       </field>
    </record>

    <record id="approve_item_action" model="ir.actions.server">
        <field name="name">Aproba foile de parcurs selectate</field>
        <field name="model_id" ref="model_fleet_fpz_foaie_de_parcurs"/>
        <field name="state">code</field>
        <field name="code">
           if context.get('active_model') == 'fleet_fpz.foaie_de_parcurs' and context.get('active_ids'):
                action = env['fleet_fpz.foaie_de_parcurs'].browse(context['active_ids']).approve_selected()
        </field>
    </record>

    <record id="action_open_invoice" model="ir.values">
      <field eval="'client_action_multi'" name="key2"/>
      <field eval="'fleet_fpz.foaie_de_parcurs'" name="model"/>
      <field name="name">Aproba</field>
      <field eval="'ir.actions.server,%d'%approve_item_action" name="value"/>
    </record>
    <!-- menu categories -->


    <menuitem action="fleet_fpz_foaie_de_parcurs_act" parent="fleet.fleet_vehicles"
      id="fleet_fpz_foaie_de_parcurs_act_menu"/> 
  </data>
</odoo>
