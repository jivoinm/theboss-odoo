<odoo>
  <data>
    <!-- explicit list view definition -->
    <!-- Inherit Form view -->
    <record id="fleet_fpz_fleet_vehicle_view_form" model="ir.ui.view">
      <field name="name">fleet.vehicle.form</field>
      <field name="model">fleet.vehicle</field>
      <field name="inherit_id" ref="fleet.fleet_vehicle_view_form"/>
      <field name="arch" type="xml">
          <xpath expr="//button" position="after">
            <field name="show_stock" invisible="1"/>
            <button name="return_action_to_open" attrs="{'invisible':[('show_stock', '=', False)]}"
                type="object"
                class="oe_stat_button"
                icon="fa-home"
                context="{'xml_id':'fleet_fpz_tank_log_fuel_action', 'show_consumed': True}"
                help="listeaza combustibil in stoc pe luna curenta" >
                <field name="in_stock" widget="statinfo" string="In Stock"/>
            </button>
            <button name="return_my_action_to_open"
                type="object"
                class="oe_stat_button"
                icon="fa-tint"
                context="{'xml_id':'fleet_vehicle_log_oil_action'}"
                domain="[('date', '>=', ((context_today()-datetime.timedelta(days=30)).strftime('%Y-%m-%d')))]"
                help="show the oil logs for this vehicle" >
                <field name="oil_logs_count" widget="statinfo" string="Oil"/>
            </button>
            <button name="return_my_action_to_open"
                type="object"
                class="oe_stat_button"
                icon="fa-file"
                context="{'xml_id':'fleet_fpz_foaie_de_parcurs_act'}"
                domain="[('date', '>=', ((context_today()-datetime.timedelta(days=30)).strftime('%Y-%m-%d')))]"
                help="Foiile de parcurs in ultimele 30 zile">
                <span>FAZ</span>
            </button>
          </xpath>
          <!-- Add your fields or attributes here -->
          <xpath expr="//group" position="after">
                 <group string="Sporuri pe masina" col="2">
                   <group>
                     <field name="cm"/>
                     <field name="spor_tractare_remorca1"/>
                     <field name="spor_tractare_remorca2"/>
                     <field name="sarcina_utila_nominala"/>
                   </group>
                   <group>
                     <field name="spor_buc"/>
                     <field name="spor_buc_cu_remorca"/>
                     <field name="spor_judet"/>
                     <field name="spor_judet_cu_remorca"/>
                     <field name="spor_alte"/>
                     <field name="spor_alte_cu_remorca"/>
                   </group>
                 </group>
             </xpath>
         
      </field>
    </record>
    <!-- Inherit Form view -->
    <record id="fleet_fpz_fleet_vehicle_make_view_form" model="ir.ui.view">
      <field name="name">fleet.vehicle.model.brand.form</field>
      <field name="model">fleet.vehicle.model.brand</field>
      <field name="inherit_id" ref="fleet.fleet_vehicle_model_brand_view_form"/>
      <field name="arch" type="xml">
          <xpath expr="//group" position="replace">
            <group col="2">
                   <group>
                      <div class="oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h1>
                            <field name="name"/>
                        </h1>
                      </div>
                   </group>
                   <group>
                      <div class="oe_button_box" name="button_box">
                        <field name="image_medium" widget="image" class="oe_avatar"/>
                      </div>
                   </group>
            </group>
            <group>
                <field name="used_for_tanking"/>
            </group>
          </xpath>
      </field>
    </record>

     <!-- Inherit Form view -->
    <record id="fleet_fpz_fleet_tank_fuel_view_form" model="ir.ui.view">
      <field name="name">fleet_fpz.tank.log.fuel.form</field>
      <field name="model">fleet_fpz.tank.log.fuel</field>
      <field name="arch" type="xml">
        <form string="Tank Logs">
              <sheet>
                  <group>
                      <group string="Vehicle Details">
                          <field name="vehicle_id"/>
                          <field name="from_vehicle_id"/>
                      </group>
                      <group string="Refueling Details">
                          <field name="liter"/>
                          <field name="price_per_liter"/>
                          <field name="amount"/>
                      </group>
                  </group>
                  <group>
                      <group string="Odometer Details">
                          <label for="odometer"/>
                          <div class="o_row">
                              <field name="odometer"/>
                              <field name="odometer_unit"/>
                          </div>
                      </group>
                      <group string="Additional Details">
                          <field name="date" />
                          <field name="purchaser_id" />
                          <field name="inv_ref" />
                          <field name="vendor_id" context="{'default_supplier': True}"/>
                      </group>
                  </group>
                  <field name="notes" placeholder="Write here any other information"/>
              </sheet>
          </form>
      </field>
    </record>

    <record id="fleet_fpz_fleet_vehicle_fuel_view_tree" model="ir.ui.view">
      <field name="name">fleet.vehicle.log.fuel.tree</field>
      <field name="model">fleet.vehicle.log.fuel</field>
      <field name="inherit_id" ref="fleet.fleet_vehicle_log_fuel_view_tree"/>
      <field name="arch" type="xml">
          <xpath expr="//tree" position="replace">
             <tree string="Fuel Logs">
                    <field name="date" />
                    <field name="vehicle_id" />
                    <field name="odometer" invisible="1"/>
                    <field name="odometer_unit" invisible="1"/>
                    <field name="purchaser_id" />
                    <field name="inv_ref"/>
                    <field name="vendor_id"/>
                    <field name="liter" sum="Litri alimentari"/>
                    <field name="price_per_liter" invisible="1"/>
                    <field name="amount" sum="Price"/>
                </tree>
          </xpath>
      </field>
    </record>

    <record id="fleet_fpz_fleet_tank_fuel_view_tree" model="ir.ui.view">
      <field name="name">fleet_fpz.tank.log.fuel.tree</field>
      <field name="model">fleet_fpz.tank.log.fuel</field>
      <field name="arch" type="xml">
              <tree string="Fuel Logs">
                  <field name="date" />
                  <field name="from_vehicle_id" />
                  <field name="vehicle_id" />
                  <field name="odometer" invisible="1"/>
                  <field name="odometer_unit" invisible="1"/>
                  <field name="purchaser_id" />
                  <field name="inv_ref"/>
                  <field name="vendor_id"/>
                  <field name="liter" sum="Total Litri"/>
                  <field name="price_per_liter" invisible="1"/>
                  <field name="amount" sum="Price"/>
              </tree>
          </field>
    </record>
    <record id='fleet_fpz_report_consum_pivot' model='ir.ui.view'>
            <field name="name">fleet_fpz.report.consum.pivot</field>
            <field name="model">fleet_fpz.report.consum</field>
            <field name="arch" type="xml">
                <pivot string="Alimentari" disable_linking="true" display_quantity="false">
                    <field name="name" type="row"/>
                    <field name="liters_fill_in" type="measure"/>
                    <field name="liters_fill_out" type="measure"/>
                    <field name="liters_oil" type="measure"/>
                </pivot>
            </field>
    </record>
    <record id="fleet_fpz_fleet_vehicle_fuel_view_search" model="ir.ui.view">
        <field name="name">fleet.vehicle.log.fuel.form</field>
        <field name="model">fleet.vehicle.log.fuel</field>
        <field name="type">search</field>
        <field name="arch" type="xml">
            <search string="Stoc pe luna">
               <field name="vehicle_id" />
               <field name="date"/>
               <field name="purchaser_id" />
               <field name="liter" />
               <field name="amount" sum="Price"/>
               <filter string="Luna curenta" icon="terp-accessories-archiver" domain="[('date', '>=', datetime.date.today().replace(day=1).strftime('%Y-%m-%d'))]"/>
               <separator orientation="vertical"/>
               <filter name="group_date_vehicle_id" string="Data si vehicol" icon="fa-calendar" context="{'group_by': [u'date:month', u'vehicle_id']}"/>
            </search>
        </field>
    </record>
    <record id="fleet_fpz_fleet_tank_fuel_view_search" model="ir.ui.view">
        <field name="name">fleet_fpz.tank.log.fuel.form</field>
        <field name="model">fleet_fpz.tank.log.fuel</field>
        <field name="type">search</field>
        <field name="arch" type="xml">
            <search string="Stoc pe luna">
               <field name="from_vehicle_id" />
               <field name="vehicle_id" />
               <field name="date"/>
               <field name="purchaser_id" />
               <field name="liter" />
               <field name="amount" sum="Price"/>
               <filter string="Luna curenta" icon="terp-accessories-archiver" domain="[('date', '>=', datetime.date.today().replace(day=1).strftime('%Y-%m-%d'))]"/>
               <separator orientation="vertical"/>
               <filter name="group_date_from_vehicle_id" string="Data si vehicol" icon="fa-calendar" context="{'group_by': [u'date:month', u'from_vehicle_id']}"/>
            </search>
        </field>
    </record>

    <record model='ir.ui.view' id='fleet_fpz_foaie_de_parcurs_form'>
        <field name="name">fleet_fpz.foaie_de_parcurs.form</field>
        <field name="model">fleet_fpz.foaie_de_parcurs</field>
        <field name="arch" type="xml">
            <form string="Foaie de parcurs">
              <header>
          	    <!--This will create the statusbar, thanks to the widget. -->
          	    <field name="state" widget="statusbar"/>
             </header>
                <sheet>
                  <div class="oe_button_box" name="button_box">
                      <button name="act_show_log_cost" type="object" class="oe_read_only oe_stat_button" icon="fa-usd" help="show all the costs for this vehicle" groups="fleet.fleet_group_manager">
                          <field name="index_km_total" widget="statinfo" string="Costs"/>
                      </button>
                  </div>
                  <div class="oe_title">
                    <label for="vehicle_id" class="oe_edit_only"/>
                      <h2>
                          <field name="vehicle_id" default_focus="1" placeholder="Masina cu nr"/>
                      </h2>
                    <label for="driver_id" class="oe_edit_only"/>
                      <h2>
                          <field name="driver_id" default_focus="1" placeholder="Soferul"/>
                      </h2>
                  </div>
                    <group col="2">
                        <group>
                            <field name="date" placeholder="Data"/>
                        </group>
                        <group>
                            <field name="numar" placeholder="Foaie de parcurs Numar"/>
                        </group>
                    </group>
                    <group>
                      <notebook colspan="4">
                        <page string="Calcul consum">
                          <group col="3">
                            <group string="Transport">
                              <field name="fuel_total"/>
                              <field name="gm"/>
                              <field name="gm_m3"/>
                            </group>
                            <group string="Index contor kilometric:">
                              <field name="index_km_total"/>
                            </group>
                            <group string="Calcul consum">
                              <field name="joja_ant_rezervor"/>
                              <field name="joja_rezervor"/>
                              <field name="consum_comb_diference"/>
                            </group>
                          </group>
                         </page>
                         <page string="Parcurs: categorii drum">
                           <field name="road_categories" nolabel="1"/>
                           <group class="oe_subtotal_footer">
                             <field name="km_de_specificat"/>
                           </group>
                           <group col="3">
                             <group string="Parcurs echivalent:">
                               <field name="km_echiv_parcurs"/>
                               <field name="km_echiv_incarcat"/>
                               <field name="km_echiv_gol"/>
                             </group>
                             <group string="Timpul parcurs:">
                               <field name="timp_local" widget="float_time"/>
                               <field name="timp_inter" widget="float_time"/>
                               <field name="timp_inc_desc" widget="float_time"/>
                               <field name="total_work_time" widget="float_time"/>
                             </group>
                             <group string="Consum suplimentar:">
                               <field name="nr_porniri_opriri"/>
                               <field name="nr_incalzire_motor" attrs="{'invisible':[('conditii_nefavorabile', '!=', True)]}"/>
                               <field name="nr_curse_comb"/>
                               <field name="rezerva_aer" attrs="{'invisible':[('conditii_nefavorabile', '!=', False)]}"/>
                              <field name="conditii_nefavorabile"/>
                             </group>
                           </group>
                         </page>
                         <page string="Spor tractare circulatie urbana">
                           <group colspan="2" string="Spor circulatie urbana">
                               <table colspan="2" class="o_list_view table table-condensed table-striped">
                                 <thead>
                                   <tr>
                                     <th class="o_column">Parcurs</th>
                                     <th class="o_column">Km</th>
                                     <th class="o_column">Cu remorca?</th>
                                     <th class="o_column">Coef.</th>
                                     <th class="o_column">Km echiv.</th>
                                   </tr>
                                 </thead>
                                  <tr>
                                    <td>Bucuresti</td>
                                    <td><field name="km_urbani_buc" nolabel="1"/></td>
                                    <td><field name="km_urbani_buc_cu_remorca" nolabel="1"/></td>
                                    <td><field name="km_urbani_buc_coef" nolabel="1"/></td>
                                    <td><field name="km_urbani_buc_echiv" nolabel="1"/></td>
                                  </tr>
                                  <tr>
                                    <td>Municipii/Judet</td>
                                    <td><field name="km_urbani_judet" nolabel="1"/></td>
                                    <td><field name="km_urbani_judet_cu_remorca" nolabel="1"/></td>
                                    <td><field name="km_urbani_judet_coef" nolabel="1"/></td>
                                    <td><field name="km_urbani_judet_echiv" nolabel="1"/></td>
                                  </tr>
                                  <tr>
                                    <td>Alte orase</td>
                                    <td><field name="km_urbani_alte" nolabel="1"/></td>
                                    <td><field name="km_urbani_alte_cu_remorca" nolabel="1"/></td>
                                    <td><field name="km_urbani_alte_coef" nolabel="1"/></td>
                                    <td><field name="km_urbani_alte_echiv" nolabel="1"/></td>
                                  </tr>
                               </table>
                           </group>
                         </page>

                         <page string="Trasee">
                           <field name="trasee" nolabel="1"/>
                         </page>
                      </notebook>
                      <group class="oe_subtotal_footer">
                          <field name="consum_comb"/>
                          <field name="km_echiv_sporuri" attrs="{'readonly': True}"/>
                          <field name="km_echiv_total" attrs="{'readonly': True}"/>
                          <field name="consum" attrs="{'readonly': True}"/>
                          <field name="driver_cost" class="oe_subtotal_footer_separator"/>
                      </group>
                  </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="fleet_fpz_parcurs_drum_view_tree" model="ir.ui.view">
      <field name="name">fleet_fpz.parcurs_drum.tree</field>
      <field name="model">fleet_fpz.parcurs_drum</field>
      <field name="arch" type="xml">
        <tree string="Parcurs drum" editable="top">
          <field name="km"/>
          <field name="incarcat"/>
          <field name="categorie_drum_id"/>
          <field name="km_echivalent"/>
        </tree>
      </field>
    </record>

    <record id="fleet_fpz_parcurs_drum_traseu_view_tree" model="ir.ui.view">
      <field name="name">fleet_fpz.parcurs_drum_traseu.tree</field>
      <field name="model">fleet_fpz.parcurs_drum_traseu</field>
      <field name="arch" type="xml">
        <tree string="Parcurs drum">
          <field name="localitate_start"/>
          <field name="localitate_stop"/>
          <field name="data_start"/>
          <field name="data_stop"/>
          <field name="dist"/>
          <field name="viteza"/>
        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="fleet_fpz_foaie_de_parcurs_graph">
       <field name="name">fleet_fpz.foaie_de_parcurs.graph</field>
       <field name="model">fleet_fpz.foaie_de_parcurs</field>
       <field name="arch" type="xml">
            <graph string="Costs Per Month" stacked="True">
                <field name="date" type="row"/>
                <field name="vehicle_id" type="col"/>
                <field name="fuel_total" type="measure"/>
                <field name="consum_comb" type="measure"/>
            </graph>
        </field>
    </record>

    <record model="ir.ui.view" id="fleet_fpz_foaie_de_parcurs_tree">
       <field name="name">fleet_fpz.foaie_de_parcurs.tree</field>
       <field name="model">fleet_fpz.foaie_de_parcurs</field>
       <field name="arch" type="xml">
            <tree string="Foii de parcurs zilnice FAZ">
                <field name="date"/>
                <field name="vehicle_id"/>
                <field name="driver_id"/>
                <field name="fuel_total" sum="Total litri"/>
                <field name="consum_comb" sum="Total Consum normat de raportat"/>
                <field name="gm" sum="Total sarcina"/>
                <field name="gm_m3" sum="Total m3"/>
                <field name="index_km_total" sum="Total KM parcursi"/>
                <field name="km_echiv_parcurs" sum="Total KM Parcursi"/>
                <field name="km_echiv_total" sum="Total KM Echiv." invisible="1"/>
                <field name="consum" avg="Consum"/>
            </tree>
        </field>
    </record>

    <record model='ir.actions.act_window' id='fleet_fpz_foaie_de_parcurs_act'>
       <field name="name">Foaie de parcurs</field>
       <field name="res_model">fleet_fpz.foaie_de_parcurs</field>
       <field name="view_type">form</field>
       <field name="view_mode">tree,form,graph</field>
       <field name="help" type="html">
         <p class="oe_view_nocontent_create">
           Clic aicea pentru a create o foaie de parcurs noua
         </p><p>
           Odoo helps you managing the costs for your different
           vehicles. Costs are created automatically from services,
           contracts (fixed or recurring) and fuel logs.
         </p>
       </field>
    </record>

    <record id="approve_item_action" model="ir.actions.server">
        <field name="name">Aproba foile de parcurs selectate</field>
        <field name="model_id" ref="model_fleet_fpz_foaie_de_parcurs"/>
        <field name="state">code</field>
        <field name="code">
           if context.get('active_model') == 'fleet_fpz.foaie_de_parcurs' and context.get('active_ids'):
                action = env['fleet_fpz.foaie_de_parcurs'].browse(context['active_ids']).approve_selected()
        </field>
    </record>

    <!-- <record id="action_open_invoice" model="ir.values">
      <field eval="'client_action_multi'" name="key2"/>
      <field eval="'fleet_fpz.foaie_de_parcurs'" name="model"/>
      <field name="name">Aproba</field>
      <field eval="'ir.actions.server,%d'%approve_item_action" name="value"/>
    </record> -->
    <!-- menu categories -->
    <menuitem action="fleet_fpz_foaie_de_parcurs_act" parent="fleet.fleet_vehicles"
      id="fleet_fpz_foaie_de_parcurs_act_menu"/> 

      <record id='fleet_vehicle_log_oil_view_form' model='ir.ui.view'>
            <field name="name">fleet.vehicle.log.oil.form</field>
            <field name="model">fleet.vehicle.log.oil</field>
            <field name="arch" type="xml">
                <form string="Fuel Logs">
                    <sheet>
                        <group>
                            <group string="Vehicle Details">
                                <field name="vehicle_id"/>
                            </group>
                            <group string="Refueling Details">
                                <field name="liter"/>
                                <field name="price_per_liter"/>
                                <field name="amount"/>
                            </group>
                        </group>
                        <group>
                            <group string="Odometer Details">
                                <label for="odometer"/>
                                <div class="o_row">
                                    <field name="odometer"/>
                                    <field name="odometer_unit"/>
                                </div>
                            </group>
                            <group string="Additional Details">
                                <field name="date" />
                                <field name="purchaser_id" />
                                <field name="inv_ref" />
                                <field name="vendor_id" context="{'default_supplier': True}"/>
                            </group>
                        </group>
                        <field name="notes" placeholder="Write here any other information"/>
                    </sheet>
                </form>
            </field>
        </record>

        <record id='fleet_vehicle_log_oil_view_tree' model='ir.ui.view'>
            <field name="name">fleet.vehicle.log.oil.tree</field>
            <field name="model">fleet.vehicle.log.oil</field>
            <field name="arch" type="xml">
                <tree string="Fuel Logs">
                    <field name="date" />
                    <field name="vehicle_id" />
                    <field name="odometer" invisible="1"/>
                    <field name="odometer_unit" invisible="1"/>
                    <field name="purchaser_id" />
                    <field name="inv_ref" invisible="1"/>
                    <field name="vendor_id" invisible="1"/>
                    <field name="liter" />
                    <field name="price_per_liter" invisible="1"/>
                    <field name="amount" sum="Price"/>
                </tree>
            </field>
        </record>

        <record id='fleet_vehicle_log_oil_view_search' model='ir.ui.view'>
            <field name="name">fleet.vehicle.log.oil.search</field>
            <field name="model">fleet.vehicle.log.oil</field>
            <field name="arch" type="xml">
                <search string="Vehicles Fuel Logs" >
                    <field name="vehicle_id" />
                    <field name="date"/>
                    <field name="purchaser_id" />
                    <field name="liter" />
                    <field name="amount" sum="Price"/>
                    <group expand="0" string="Group By">
                        <filter name="groupby_vehicle" context="{'group_by' : 'vehicle_id'}" string="Vehicle"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="fleet_vehicle_log_oil_view_graph" model="ir.ui.view">
           <field name="name">fleet.vehicle.log.oil.graph</field>
           <field name="model">fleet.vehicle.log.oil</field>
           <field name="arch" type="xml">
                <graph string="Fuel Costs Per Month">
                    <field name="vehicle_id" type="row"/>
                    <field name="cost_amount" type="measure"/>
                </graph>
            </field>
        </record>

        <record id='fleet_vehicle_log_oil_action' model='ir.actions.act_window'>
            <field name="name">Vehicles Oil Logs</field>
            <field name="res_model">fleet.vehicle.log.oil</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,graph</field>
            <field name="context">{"search_default_groupby_vehicle" : True}</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a new oil log.
              </p><p>
                Here you can add refuelling entries for all vehicles.  You can
                also filter logs of a particular vehicle using the search
                field.
              </p>
            </field>
        </record>
        <record id='fleet_fpz_tank_log_fuel_action' model='ir.actions.act_window'>
            <field name="name">Tank Logs</field>
            <field name="res_model">fleet_fpz.tank.log.fuel</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,graph</field>
            <field name="context">{"search_default_group_date_from_vehicle_id" : True}</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a new tank fuel log.
              </p><p>
                Here you can add refuelling entries for all vehicles.  You can
                also filter logs of a particular vehicle using the search
                field.
              </p>
            </field>
        </record>
    
        <menuitem action="fleet_vehicle_log_oil_action" parent="fleet.fleet_vehicles" id="fleet_vehicle_log_oil_menu"/>
        <menuitem action="fleet_fpz_tank_log_fuel_action" parent="fleet.fleet_vehicles" id="fleet_tank_log_menu"/>

  </data>
</odoo>
